!function(o){function n(o){this.mode=c.MODE_8BIT_BYTE,this.data=o,this.parsedData=[];for(var n=0,e=this.data.length;n<e;n++){var t=[],r=this.data.charCodeAt(n);r>65536?(t[0]=240|(1835008&r)>>>18,t[1]=128|(258048&r)>>>12,t[2]=128|(4032&r)>>>6,t[3]=128|63&r):r>2048?(t[0]=224|(61440&r)>>>12,t[1]=128|(4032&r)>>>6,t[2]=128|63&r):r>128?(t[0]=192|(1984&r)>>>6,t[1]=128|63&r):t[0]=r,this.parsedData.push(t)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function e(o,n){this.typeNumber=o,this.errorCorrectLevel=n,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function t(o,n){if(void 0==o.length)throw new Error(o.length+"/"+n);for(var e=0;e<o.length&&0==o[e];)e++;this.num=new Array(o.length-e+n);for(var t=0;t<o.length-e;t++)this.num[t]=o[t+e]}var c={};n.prototype={getLength:function(){return this.parsedData.length},write:function(o){for(var n=0,e=this.parsedData.length;n<e;n++)o.put(this.parsedData[n],8)}},c.PAD0=236,c.PAD1=17,c.MODE_NUMBER=1,c.MODE_ALPHA_NUM=2,c.MODE_8BIT_BYTE=4,c.MODE_KANJI=8,c.ErrorCorrectLevel={L:1,M:0,Q:3,H:2},c.QRNumber={getLength:function(o){return o.length},write:function(o,n){for(var e=0,t=o.length;e<t;e++)n.put(parseInt(o.charAt(e),10),4)}},c.QRAlphaNum={getLength:function(o){return o.length},write:function(o,n){for(var e=0,t=o.length;e<t;e++)n.put("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:".indexOf(o.charAt(e)),6)}},c.QR8BitByte=n,c.QRUtil={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74]],getBCHTypeInfo:function(o){for(var n=o<<10;this.getBCHDigit(n)-this.getBCHDigit(1335)>=0;)n^=1335<<this.getBCHDigit(n)-this.getBCHDigit(1335);return(o<<10|n)^21522},getBCHTypeNumber:function(o){for(var n=o<<12;this.getBCHDigit(n)-this.getBCHDigit(7973)>=0;)n^=7973<<this.getBCHDigit(n)-this.getBCHDigit(7973);return o<<12|n},getBCHDigit:function(o){var n=0;for(;0!=o;)n++,o>>>=1;return n},getPatternPosition:function(o){return this.PATTERN_POSITION_TABLE[o-1]},getMask:function(o,n,e){switch(o){case 0:return(n+e)%2==0;case 1:return n%2==0;case 2:return e%3==0;case 3:return(n+e)%3==0;case 4:return(Math.floor(n/2)+Math.floor(e/3))%2==0;case 5:return n*e%2+n*e%3==0;case 6:return(n*e%2+n*e%3)%2==0;case 7:return(n*e%3+Math.floor(n*e/3))%2==0;default:throw new Error("bad maskPattern:")+o}},getErrorCorrectPolynomial:function(o){for(var n=new t([1],0),e=0;e<o;e++)n=n.multiply(new t([1,Math.pow(2,e)],0));return n},getLengthInBits:function(o,n){if(1<=n&&n<10)switch(o){case 1:return 10;case 2:return 9;case 4:return 8;case 8:return 8;default:throw new Error("mode:")+o}else if(n<16)switch(o){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw new Error("mode:")+o}else{if(!(n<40))throw new Error("type:")+n;switch(o){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12}}},getLostPoint:function(o){for(var n=o.getModuleCount(),e=0,t=0;t<n;t++)for(var c=0;c<n;c++){var r=0,u=o.isDark(t,c);for(var i=-1;i<=1;i++)if(!(t+i<0||n<=t+i))for(var a=-1;a<=1;a++)c+a<0||n<=c+a||0==i&&0==a||u==o.isDark(t+i,c+a)&&r++;r>5&&(e+=3+r-5)}for(t=0;t<n;t++)for(c=0;c<n-6;c++)o.isDark(t,c)&&!o.isDark(t,c+1)&&o.isDark(t,c+2)&&o.isDark(t,c+3)&&o.isDark(t,c+4)&&!o.isDark(t,c+5)&&o.isDark(t,c+6)&&(e+=40);for(c=0;c<n;c++)for(t=0;t<n-6;t++)o.isDark(t,c)&&!o.isDark(t+1,c)&&o.isDark(t+2,c)&&o.isDark(t+3,c)&&o.isDark(t+4,c)&&!o.isDark(t+5,c)&&o.isDark(t+6,c)&&(e+=40);for(var f=0,h=0,c=0;c<n;c++)for(t=0;t<n;t++)o.isDark(t,c)&&f++;h=Math.abs(100*f/n/n-50)/5*10;return e+h}},t.prototype={get:function(o){return this.num[o]},getLength:function(){return this.num.length},multiply:function(o){for(var n=new Array(this.getLength()+o.getLength()-1),e=0;e<n.length;e++)n[e]=0;for(e=0;e<this.getLength();e++)for(var t=0;t<o.getLength();t++)n[e+t]^=c.QRMath.gexp(c.QRMath.glog(this.get(e))+c.QRMath.glog(o.get(t)));return new t(n,0)},mod:function(o){for(var n=this.getLength()-o.getLength();n>=0;n--)for(var e=c.QRMath.glog(this.get(0))-c.QRMath.glog(o.get(0)),t=0;t<o.getLength();t++)this.num[t]^=c.QRMath.gexp(c.QRMath.glog(o.get(t))+e);for(;0==this.num[0];)this.num.shift();return this}},c.QRMath={glog:function(o){if(o<1)throw new Error("glog("+o+")");return c.QRMath.LOG_TABLE[o]},gexp:function(o){for(;o<0;)o+=255;for(;o>=256;)o-=255;return c.QRMath.EXP_TABLE[o]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},c.QRMath.EXP_TABLE[0]=1;for(var r=1;r<256;r++)c.QRMath.EXP_TABLE[r]=c.QRMath.EXP_TABLE[r-1]<<1,c.QRMath.EXP_TABLE[r]>=256&&(c.QRMath.EXP_TABLE[r]^=285);for(var r=0;r<255;r++)c.QRMath.LOG_TABLE[c.QRMath.EXP_TABLE[r]]=r;e.prototype={addData:function(o){var e=new n(o);this.dataList.push(e),this.dataCache=null},isDark:function(o,n){if(null==this.modules)throw new Error("modules is null");if(o<0||this.moduleCount<=o||n<0||this.moduleCount<=n)throw new Error(o+","+n);return this.modules[o][n]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(o,n){this.moduleCount=4*10+17,this.modules=new Array(this.moduleCount);for(var e=0;e<this.moduleCount;e++){this.modules[e]=new Array(this.moduleCount);for(var t=0;t<this.moduleCount;t++)this.modules[e][t]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(o,n),this.mapData(this.createData(),n)},setupPositionProbePattern:function(o,n){for(var e=-1;e<=7;e++)if(!(o+e<=-1||this.moduleCount<=o+e))for(var t=-1;t<=7;t++)n+t<=-1||this.moduleCount<=n+t||(this.modules[o+e][n+t]=e>=0&&e<=6&&(0==t||6==t)||t>=0&&t<=6&&(0==e||6==e)||e>=2&&e<=4&&t>=2&&t<=4)},getBestMaskPattern:function(){for(var o=0,n=0,e=0;e<8;e++){this.makeImpl(!0,e);var t=c.QRUtil.getLostPoint(this);(0==e||o>t)&&(o=t,n=e)}return n},createData:function(){for(var o=new c.BitBuffer,n=0;n<this.dataList.length;n++){var e=this.dataList[n];o.put(4,4),o.put(e.getLength(),c.QRUtil.getLengthInBits(4,10)),e.write(o)}for(var t=this.getRSBlocks(),r=0;r<t.length;r++)o.put(0,4);for(;o.length+4<=8*t.length;)o.put(0,4);for(;o.length%8!=0;)o.put(0,1);for(var u=new Array,o=0;o<8*t.length;o++)u.push(0);for(r=0;r<this.dataList.length;r++){var i=this.dataList[r];i.write({put:function(n,e){for(var t=e-1;t>=0;t--)u[o++]=1==(n>>>t&1)?1:0}})}return u},setupTimingPattern:function(){for(var o=8;o<this.moduleCount-8;o++)null==this.modules[o][6]&&(this.modules[o][6]=o%2==0),null==this.modules[6][o]&&(this.modules[6][o]=o%2==0)},setupPositionAdjustPattern:function(){for(var o=c.QRUtil.getPatternPosition(10),n=0;n<o.length;n++)for(var e=0;e<o.length;e++){var t=o[n],r=o[e];if(null==this.modules[t][r])for(var u=-2;u<=2;u++)for(var i=-2;i<=2;i++)this.modules[t+u][r+i]=-2==u||2==u||-2==i||2==i||0==u&&0==i}},setupTypeInfo:function(o,n){for(var e=c.QRUtil.getBCHTypeInfo(this.errorCorrectLevel<<3|n),t=0;t<15;t++){var r=!o&&1==(e>>t&1);t<6?this.modules[t][8]=r:t<8?this.modules[t+1][8]=r:this.modules[this.moduleCount-15+t][8]=r}for(t=0;t<15;t++)this.modules[8][t<8?t:t+1]=!o&&1==(e>>t&1)},mapData:function(o,n){for(var e=-1,t=this.moduleCount-1,r=7,u=0,i=this.moduleCount-1;i>0;i-=2){6==i&&i--;for(;;){for(var a=0;a<2;a++)null==this.modules[t][i-a]&&(this.modules[t][i-a]=u<o.length?1==o[u++]:!1);if((t+=e)<0||this.moduleCount<=t){t-=e,e=-e;break}}}var f=this;this.isDark=function(o,n){var e=f.modules[o][n];return 1==e||!0===e}}},c.BitBuffer=function(){this.buffer=[],this.length=0},c.BitBuffer.prototype={get:function(o){return 1==(this.buffer[Math.floor(o/8)]>>>7-o%8&1)},put:function(o,n){for(var e=0;e<n;e++)this.putBit(1==(o>>>n-e-1&1))},getLengthInBits:function(){return this.length},putBit:function(o){var n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),o&&(this.buffer[n]|=128>>>this.length%8),this.length++}},c.stringToBytes=function(o){for(var n=[],e=0;e<o.length;e++){var t=o.charCodeAt(e);t<128?n.push(t):t<2048?(n.push(192|t>>6),n.push(128|63&t)):(n.push(224|t>>12),n.push(128|63&t>>6),n.push(128|63&t))}return n},c.createStringToBytes=function(){return c.stringToBytes},o.QRCode=function(o){this._el=document.getElementById(o)},o.QRCode.prototype.makeCode=function(o){for(var n=new e(10,c.ErrorCorrectLevel.M),t=c.createStringToBytes()(o),r=new (c.QR8BitByte)(String.fromCharCode.apply(null,t));;)try{n.addData(r),n.make();break}catch(u){if(n.typeNumber++,n.typeNumber>40)throw new Error("Too long data")}for(var i=n.getModuleCount(),a=10*i+4,f=document.createElement("canvas");;)try{f.width=a,f.height=a;break}catch(u){return}var h=f.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,a,a),h.fillStyle="#000";for(var l=0;l<i;l++)for(var s=0;s<i;s++)n.isDark(l,s)&&h.fillRect(10*l+2,10*s+2,10,10);this._el.innerHTML="",this._el.appendChild(f)}}(window);
